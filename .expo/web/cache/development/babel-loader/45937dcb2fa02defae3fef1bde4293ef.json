{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport React, { useEffect, useState } from 'react';\nimport AppRegistry from \"react-native-web/dist/exports/AppRegistry\";\nimport ChildrenWrapper from \"./ChildrenWrapper\";\nimport wrapRootComponent from \"./wrapRootComponent\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nvar siblingWrapper = function siblingWrapper(sibling) {\n  return sibling;\n};\n\nfunction renderSibling(sibling) {\n  return siblingWrapper(sibling);\n}\n\nif (!global.__rootSiblingsInjected && !global.__rootSiblingsDisabled) {\n  AppRegistry.setWrapperComponentProvider(function () {\n    return Root;\n  });\n  global.__rootSiblingsInjected = true;\n}\n\nexport function setSiblingWrapper(wrapper) {\n  siblingWrapper = wrapper;\n}\n\nvar _wrapRootComponent = wrapRootComponent(ChildrenWrapper, renderSibling),\n    Root = _wrapRootComponent.Root,\n    defaultManager = _wrapRootComponent.manager;\n\nvar uuid = 0;\nvar managerStack = [defaultManager];\nvar inactiveManagers = new Set();\n\nfunction getActiveManager() {\n  for (var i = managerStack.length - 1; i >= 0; i--) {\n    var manager = managerStack[i];\n\n    if (!inactiveManagers.has(manager)) {\n      return manager;\n    }\n  }\n\n  return defaultManager;\n}\n\nvar RootSiblingsManager = function () {\n  function RootSiblingsManager(element, callback) {\n    _classCallCheck(this, RootSiblingsManager);\n\n    this.id = \"root-sibling-\" + (uuid + 1);\n    this.manager = getActiveManager();\n    this.manager.update(this.id, element, callback);\n    uuid++;\n  }\n\n  _createClass(RootSiblingsManager, [{\n    key: \"update\",\n    value: function update(element, callback) {\n      this.manager.update(this.id, element, callback);\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy(callback) {\n      this.manager.destroy(this.id, callback);\n    }\n  }]);\n\n  return RootSiblingsManager;\n}();\n\nexport { RootSiblingsManager as default };\nexport function RootSiblingParent(props) {\n  var inactive = props.inactive;\n\n  var _useState = useState(function () {\n    var _wrapRootComponent2 = wrapRootComponent(ChildrenWrapper, renderSibling),\n        parentRoot = _wrapRootComponent2.Root,\n        parentManager = _wrapRootComponent2.manager;\n\n    managerStack.push(parentManager);\n\n    if (inactive) {\n      inactiveManagers.add(parentManager);\n    }\n\n    return {\n      Root: parentRoot,\n      manager: parentManager\n    };\n  }),\n      _useState2 = _slicedToArray(_useState, 1),\n      sibling = _useState2[0];\n\n  useEffect(function () {\n    return function () {\n      if (sibling) {\n        var index = managerStack.indexOf(sibling.manager);\n\n        if (index > 0) {\n          managerStack.splice(index, 1);\n        }\n      }\n    };\n  }, [sibling]);\n\n  if (inactive && sibling && !inactiveManagers.has(sibling.manager)) {\n    inactiveManagers.add(sibling.manager);\n  } else if (!inactive && sibling && inactiveManagers.has(sibling.manager)) {\n    inactiveManagers.delete(sibling.manager);\n  }\n\n  var Parent = sibling.Root;\n  return _jsx(Parent, {\n    children: props.children\n  });\n}\nexport function RootSiblingPortal(props) {\n  var _useState3 = useState(function () {\n    return new RootSiblingsManager(null);\n  }),\n      _useState4 = _slicedToArray(_useState3, 1),\n      sibling = _useState4[0];\n\n  sibling.update(props.children);\n  useEffect(function () {\n    if (sibling) {\n      return function () {\n        return sibling.destroy();\n      };\n    }\n  }, [sibling]);\n  return null;\n}","map":{"version":3,"mappings":"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","names":["React","useEffect","useState","ChildrenWrapper","wrapRootComponent","siblingWrapper","sibling","renderSibling","global","__rootSiblingsInjected","__rootSiblingsDisabled","AppRegistry","setWrapperComponentProvider","Root","setSiblingWrapper","wrapper","defaultManager","manager","uuid","managerStack","inactiveManagers","Set","getActiveManager","i","length","has","RootSiblingsManager","element","callback","id","update","destroy","RootSiblingParent","props","inactive","parentRoot","parentManager","push","add","index","indexOf","splice","delete","Parent","children","RootSiblingPortal"],"sourceRoot":"","sources":["../src/RootSiblingsManager.tsx"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}